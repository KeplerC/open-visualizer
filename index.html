<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Open-X Dataset Visualizer</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <style>
    #page-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5); /* Semi-transparent black */
      z-index: 9999; /* Ensure it's on top */
    }

    .checkbox-container {
      font-size: small;
      margin-bottom: -0.75rem;
      width: fit-content;
    }

    @media (min-width: 768px) {
      #video-grid {
        overflow-y: scroll; /* Always show the vertical scrollbar */
        max-height: 90vh;
      }
    }

    .video-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.65);
      opacity: 0;
      transition: opacity 0.3s ease;
      color: white; /* White text */
      display: flex;
      justify-content: center;
      text-align: center;
      align-items: center;
      font-size: 0.75rem;
    }

    .video-overlay:hover {
      opacity: 1;
    }
  </style>
</head>
<body>
  <div id="page-overlay"></div>

  <div class="container mt-3">
    <div class="row">
      <h1 class="d-md-block d-none">Open-X Dataset Visualizer</h1>
      <h3 class="d-block d-md-none">Open-X Dataset Visualizer</h3>
      
      <p class="d-md-block d-none ml-3 mb-0 align-self-center">(Showing random subset of 1k trajectories from Open-X; website template from DROID Visualizer)</p>
      <p class="d-block d-md-none small">(Showing random subset of 1k trajectories from Open-X; website template from DROID Visualizer)</p>
      
    </div>

    <div class="row">
      <div class="col-md-2 px-1 col-12">
        <div class="mb-2 pr-5">
          <button class="btn btn-outline-dark btn-sm" id="resample-button" style="display: none;">Resample</button>
          <p class="small mb-2" id="info-text"></p>
        </div>

        <div class="mb-2" id="view-checkbox-group">
          <h5 class="mb-1">View Types</h5>

          <div class="checkbox-container">
            <label for="view-all-checkbox">
              <input type="checkbox" id="view-all-checkbox" checked>
              All (<span id="view-all-count">0</span>)
            </label>
          </div>
        
          <div class="checkbox-container">
            <label for="view-1">
              <input type="checkbox" class="view-checkbox" id="view-1">
              Wrist (<span id="view-1-count">0</span>)
            </label>
          </div>
        
          <div class="checkbox-container">
            <label for="view-2">
              <input type="checkbox" class="view-checkbox" id="view-2">
              Top (<span id="view-2-count">0</span>)
            </label>
          </div>
      
          <div class="checkbox-container">
            <label for="view-3">
              <input type="checkbox" class="view-checkbox" id="view-3">
              Other (<span id="view-3-count">0</span>)
            </label>
          </div>
        </div>
      
        <div class="mb-2" id="object-checkbox-group">
          <h5 class="mb-1">Object Types</h5>

          <div class="checkbox-container">
            <label for="object-all-checkbox">
              <input type="checkbox" id="object-all-checkbox" checked>
              All (<span id="object-all-count">0</span>)
            </label>
          </div>
        
          <div class="checkbox-container">
            <label for="object-1">
              <input type="checkbox" class="object-checkbox" id="object-1">
              Marker (<span id="object-1-count">0</span>)
            </label>
          </div>
        
          <div class="checkbox-container">
            <label for="object-2">
              <input type="checkbox" class="object-checkbox" id="object-2">
              Cloth (<span id="object-2-count">0</span>)
            </label>
          </div>
        
          <div class="checkbox-container">
            <label for="object-3">
              <input type="checkbox" class="object-checkbox" id="object-3">
              Cup (<span id="object-3-count">0</span>)
            </label>
          </div>
        
          <div class="checkbox-container">
            <label for="object-4">
              <input type="checkbox" class="object-checkbox" id="object-4">
              Object (<span id="object-4-count">0</span>)
            </label>
          </div>
        
          <div class="checkbox-container">
            <label for="object-5">
              <input type="checkbox" class="object-checkbox" id="object-5">
              Bottle (<span id="object-5-count">0</span>)
            </label>
          </div>
        
          <div class="checkbox-container">
            <label for="object-6">
              <input type="checkbox" class="object-checkbox" id="object-6">
              Block (<span id="object-6-count">0</span>)
            </label>
          </div>
        
          <div class="checkbox-container">
            <label for="object-7">
              <input type="checkbox" class="object-checkbox" id="object-7">
              Drawer (<span id="object-7-count">0</span>)
            </label>
          </div>
        
          <div class="checkbox-container">
            <label for="object-8">
              <input type="checkbox" class="object-checkbox" id="object-8">
              Lid (<span id="object-8-count">0</span>)
            </label>
          </div>
        
          <div class="checkbox-container">
            <label for="object-9">
              <input type="checkbox" class="object-checkbox" id="object-9">
              Mug (<span id="object-9-count">0</span>)
            </label>
          </div>
        
          <div class="checkbox-container">
            <label for="object-10">
              <input type="checkbox" class="object-checkbox" id="object-10">
              Other (<span id="object-10-count">0</span>)
            </label>
          </div>
        </div>
      
        <div class="mb-2" id="task-checkbox-group">
          <h5 class="mb-1">Task Types</h5>

          <div class="checkbox-container">
            <label for="task-all-checkbox">
              <input type="checkbox" id="task-all-checkbox" checked>
              All (<span id="task-all-count">0</span>)
            </label>
          </div>
        
          <div class="checkbox-container">
            <label for="task-1">
              <input type="checkbox" class="task-checkbox" id="task-1">
              Put (<span id="task-1-count">0</span>)
            </label>
          </div>
        
          <div class="checkbox-container">
            <label for="task-2">
              <input type="checkbox" class="task-checkbox" id="task-2">
              Move (<span id="task-2-count">0</span>)
            </label>
          </div>
        
          <div class="checkbox-container">
            <label for="task-3">
              <input type="checkbox" class="task-checkbox" id="task-3">
              Pick (<span id="task-3-count">0</span>)
            </label>
          </div>
        
          <div class="checkbox-container">
            <label for="task-4">
              <input type="checkbox" class="task-checkbox" id="task-4">
              Remove (<span id="task-4-count">0</span>)
            </label>
          </div>
        
          <div class="checkbox-container">
            <label for="task-5">
              <input type="checkbox" class="task-checkbox" id="task-5">
              Take (<span id="task-5-count">0</span>)
            </label>
          </div>
        
          <div class="checkbox-container">
            <label for="task-6">
              <input type="checkbox" class="task-checkbox" id="task-6">
              Open (<span id="task-6-count">0</span>)
            </label>
          </div>
        
          <div class="checkbox-container">
            <label for="task-7">
              <input type="checkbox" class="task-checkbox" id="task-7">
              Close (<span id="task-7-count">0</span>)
            </label>
          </div>
        
          <div class="checkbox-container">
            <label for="task-8">
              <input type="checkbox" class="task-checkbox" id="task-8">
              Place (<span id="task-8-count">0</span>)
            </label>
          </div>
        
          <div class="checkbox-container">
            <label for="task-9">
              <input type="checkbox" class="task-checkbox" id="task-9">
              Turn (<span id="task-9-count">0</span>)
            </label>
          </div>
        
          <div class="checkbox-container">
            <label for="task-10">
              <input type="checkbox" class="task-checkbox" id="task-10">
              Push (<span id="task-10-count">0</span>)
            </label>
          </div>

          <div class="checkbox-container">
            <label for="task-11">
              <input type="checkbox" class="task-checkbox" id="task-11">
              Insert (<span id="task-11-count">0</span>)
            </label>
          </div>

          <div class="checkbox-container">
            <label for="task-12">
              <input type="checkbox" class="task-checkbox" id="task-12">
              Stack (<span id="task-12-count">0</span>)
            </label>
          </div>

          <div class="checkbox-container">
            <label for="task-13">
              <input type="checkbox" class="task-checkbox" id="task-13">
              Lift (<span id="task-13-count">0</span>)
            </label>
          </div>

          <div class="checkbox-container">
            <label for="task-14">
              <input type="checkbox" class="task-checkbox" id="task-14">
              Pour (<span id="task-14-count">0</span>)
            </label>
          </div>


          <div class="checkbox-container">
            <label for="task-15">
              <input type="checkbox" class="task-checkbox" id="task-15">
              Other (<span id="task-15-count">0</span>)
            </label>
          </div>
        </div>
      
        <div class="mb-2" id="dataset-checkbox-group" style="overflow:scroll; height:400px;">
          <h5 class="mb-1">Dataset</h5>

          <div class="checkbox-container">
            <label for="dataset-all-checkbox">
              <input type="checkbox" id="dataset-all-checkbox" checked>
              All (<span id="dataset-all-count">0</span>)
            </label>
          </div>

          <div class="checkbox-container">
            <label for="dataset-1">
              <input type="checkbox" class="dataset-checkbox" id="dataset-1">
              fractal20220817_data (<span id="dataset-1-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-2">
              <input type="checkbox" class="dataset-checkbox" id="dataset-2">
              kuka (<span id="dataset-2-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-3">
              <input type="checkbox" class="dataset-checkbox" id="dataset-3">
              bridge (<span id="dataset-3-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-4">
              <input type="checkbox" class="dataset-checkbox" id="dataset-4">
              taco_play (<span id="dataset-4-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-5">
              <input type="checkbox" class="dataset-checkbox" id="dataset-5">
              jaco_play (<span id="dataset-5-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-6">
              <input type="checkbox" class="dataset-checkbox" id="dataset-6">
              berkeley_cable_routing (<span id="dataset-6-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-7">
              <input type="checkbox" class="dataset-checkbox" id="dataset-7">
              roboturk (<span id="dataset-7-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-8">
              <input type="checkbox" class="dataset-checkbox" id="dataset-8">
              nyu_door_opening_surprising_effectiveness (<span id="dataset-8-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-9">
              <input type="checkbox" class="dataset-checkbox" id="dataset-9">
              viola (<span id="dataset-9-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-10">
              <input type="checkbox" class="dataset-checkbox" id="dataset-10">
              berkeley_autolab_ur5 (<span id="dataset-10-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-11">
              <input type="checkbox" class="dataset-checkbox" id="dataset-11">
              toto (<span id="dataset-11-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-12">
              <input type="checkbox" class="dataset-checkbox" id="dataset-12">
              columbia_cairlab_pusht_real (<span id="dataset-12-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-13">
              <input type="checkbox" class="dataset-checkbox" id="dataset-13">
              stanford_kuka_multimodal_dataset (<span id="dataset-13-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-14">
              <input type="checkbox" class="dataset-checkbox" id="dataset-14">
              nyu_rot_dataset (<span id="dataset-14-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-15">
              <input type="checkbox" class="dataset-checkbox" id="dataset-15">
              stanford_hydra_dataset (<span id="dataset-15-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-16">
              <input type="checkbox" class="dataset-checkbox" id="dataset-16">
              austin_buds_dataset (<span id="dataset-16-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-17">
              <input type="checkbox" class="dataset-checkbox" id="dataset-17">
              nyu_franka_play_dataset (<span id="dataset-17-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-18">
              <input type="checkbox" class="dataset-checkbox" id="dataset-18">
              maniskill_dataset (<span id="dataset-18-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-19">
              <input type="checkbox" class="dataset-checkbox" id="dataset-19">
              cmu_franka_exploration_dataset (<span id="dataset-19-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-20">
              <input type="checkbox" class="dataset-checkbox" id="dataset-20">
              ucsd_kitchen_dataset (<span id="dataset-20-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-21">
              <input type="checkbox" class="dataset-checkbox" id="dataset-21">
              ucsd_pick_and_place_dataset (<span id="dataset-21-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-22">
              <input type="checkbox" class="dataset-checkbox" id="dataset-22">
              austin_sailor_dataset (<span id="dataset-22-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-23">
              <input type="checkbox" class="dataset-checkbox" id="dataset-23">
              austin_sirius_dataset (<span id="dataset-23-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-24">
              <input type="checkbox" class="dataset-checkbox" id="dataset-24">
              bc_z (<span id="dataset-24-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-25">
              <input type="checkbox" class="dataset-checkbox" id="dataset-25">
              usc_cloth_sim (<span id="dataset-25-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-26">
              <input type="checkbox" class="dataset-checkbox" id="dataset-26">
              utokyo_pr2_opening_fridge (<span id="dataset-26-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-27">
              <input type="checkbox" class="dataset-checkbox" id="dataset-27">
              utokyo_pr2_tabletop_manipulation (<span id="dataset-27-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-28">
              <input type="checkbox" class="dataset-checkbox" id="dataset-28">
              utokyo_saytap (<span id="dataset-28-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-29">
              <input type="checkbox" class="dataset-checkbox" id="dataset-29">
              utokyo_xarm_pick_and_place (<span id="dataset-29-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-30">
              <input type="checkbox" class="dataset-checkbox" id="dataset-30">
              utokyo_xarm_bimanual (<span id="dataset-30-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-31">
              <input type="checkbox" class="dataset-checkbox" id="dataset-31">
              robo_net (<span id="dataset-31-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-32">
              <input type="checkbox" class="dataset-checkbox" id="dataset-32">
              berkeley_mvp (<span id="dataset-32-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-33">
              <input type="checkbox" class="dataset-checkbox" id="dataset-33">
              berkeley_rpt (<span id="dataset-33-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-34">
              <input type="checkbox" class="dataset-checkbox" id="dataset-34">
              kaist_nonprehensile (<span id="dataset-34-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-35">
              <input type="checkbox" class="dataset-checkbox" id="dataset-35">
              stanford_mask_vit (<span id="dataset-35-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-36">
              <input type="checkbox" class="dataset-checkbox" id="dataset-36">
              tokyo_u_lsmo (<span id="dataset-36-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-37">
              <input type="checkbox" class="dataset-checkbox" id="dataset-37">
              dlr_sara_pour (<span id="dataset-37-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-38">
              <input type="checkbox" class="dataset-checkbox" id="dataset-38">
              dlr_sara_grid_clamp (<span id="dataset-38-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-39">
              <input type="checkbox" class="dataset-checkbox" id="dataset-39">
              dlr_edan_shared_control (<span id="dataset-39-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-40">
              <input type="checkbox" class="dataset-checkbox" id="dataset-40">
              asu_table_top (<span id="dataset-40-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-41">
              <input type="checkbox" class="dataset-checkbox" id="dataset-41">
              stanford_robocook (<span id="dataset-41-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-42">
              <input type="checkbox" class="dataset-checkbox" id="dataset-42">
              eth_agent_affordances (<span id="dataset-42-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-43">
              <input type="checkbox" class="dataset-checkbox" id="dataset-43">
              imperialcollege_sawyer_wrist_cam (<span id="dataset-43-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-44">
              <input type="checkbox" class="dataset-checkbox" id="dataset-44">
              iamlab_cmu_pickup_insert (<span id="dataset-44-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-45">
              <input type="checkbox" class="dataset-checkbox" id="dataset-45">
              uiuc_d3field (<span id="dataset-45-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-46">
              <input type="checkbox" class="dataset-checkbox" id="dataset-46">
              utaustin_mutex (<span id="dataset-46-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-47">
              <input type="checkbox" class="dataset-checkbox" id="dataset-47">
              berkeley_fanuc_manipulation (<span id="dataset-47-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-48">
              <input type="checkbox" class="dataset-checkbox" id="dataset-48">
              cmu_play_fusion (<span id="dataset-48-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-49">
              <input type="checkbox" class="dataset-checkbox" id="dataset-49">
              cmu_stretch (<span id="dataset-49-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-50">
              <input type="checkbox" class="dataset-checkbox" id="dataset-50">
              berkeley_gnm_recon (<span id="dataset-50-count">0</span>)
            </label>
          </div>
    

          <div class="checkbox-container">
            <label for="dataset-51">
              <input type="checkbox" class="dataset-checkbox" id="dataset-51">
              berkeley_gnm_cory_hall (<span id="dataset-51-count">0</span>)
            </label>
          </div>
        
          <div class="checkbox-container">
            <label for="dataset-52">
              <input type="checkbox" class="dataset-checkbox" id="dataset-52">
              other (<span id="dataset-52-count">0</span>)
            </label>
          </div>
        </div>

      </div>

      <div class="col" id="video-grid">
        <div class="row">
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        
          <div class="col-md-3 p-1 d-flex">
            <video class="border" autoplay loop muted playsinline width="100%" type="video/mp4"></video>
            <div class="video-overlay p-3"><span></span></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Video metadata
    const videos = [JSON.parse('{"dataset_id": "dataset-51", "info": "navigate to the goal.", "task_id": "task-15", "object_id": "object-10", "poster": "videos/berkeley_gnm_cory_hall_viz/berkeley_gnm_cory_hall_99_image.jpg", "src": "videos/berkeley_gnm_cory_hall_viz/berkeley_gnm_cory_hall_99_image.mp4", "view_id": "view-3"}'),
JSON.parse('{"dataset_id": "dataset-51", "info": "navigate to the goal.", "task_id": "task-15", "object_id": "object-10", "poster": "videos/berkeley_gnm_cory_hall_viz/berkeley_gnm_cory_hall_100_image.jpg", "src": "videos/berkeley_gnm_cory_hall_viz/berkeley_gnm_cory_hall_100_image.mp4", "view_id": "view-3"}'),  
  ];

    const filters = [
      'view',
      'object',
      'task',
      'dataset',
    ];

    const maxVisibleVideos = 40;

    // Cache references to DOM elements
    const infoTextElement = document.getElementById('info-text');
    const resampleButton = document.getElementById('resample-button');
    const videoGrid = document.getElementById('video-grid');
    const videoElements = document.querySelectorAll('video');
    const videoOverlays = document.querySelectorAll('.video-overlay');
    const videoOverlaySpans = document.querySelectorAll('.video-overlay span');

    // Cache references to filter DOM elements
    const filterElements = {};
    filters.forEach(filter => {
      const checkboxes = document.querySelectorAll(`.${filter}-checkbox`);
      const checkboxLabels = {};
      const checkboxCounts = {};
      checkboxes.forEach(checkbox => {
        checkboxLabels[checkbox.id] = document.querySelector(`label[for='${checkbox.id}']`);;
        checkboxCounts[checkbox.id] = document.getElementById(`${checkbox.id}-count`);
      });
      const allCheckbox = document.getElementById(`${filter}-all-checkbox`);
      const allCheckboxCount = document.getElementById(`${filter}-all-count`)
      filterElements[filter] = { checkboxes, checkboxLabels, checkboxCounts, allCheckbox, allCheckboxCount };
    });

    // Function to perform Fisher-Yates shuffle algorithm
    function fisherYatesShuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    // Generate array of indices for shuffling
    const indices = Array.from({ length: videos.length }, (_, index) => index)
    fisherYatesShuffle(indices)

    // Create an IntersectionObserver to lazily load videos when they come into view
    const lazyVideoObserver = new IntersectionObserver(function(entries, observer) {
      entries.forEach(function(video) {
        if (video.isIntersecting) {
          video.target.load();
          observer.unobserve(video.target);
        }
      });
    });

    // Function to get selected filters
    function getSelectedValues(checkboxes) {
      return Array.from(checkboxes).filter(filter => filter.checked).map(filter => filter.id);
    }

    // Function to filter videos based on selected filters
    function filterVideos() {
      // console.time('filterVideos');

      // Stop all video observers
      lazyVideoObserver.disconnect();

      // Hide the video grid temporarily to facilitate batch-like editing of the DOM
      videoGrid.style.display = 'none';

      // Get selected values for each filter
      const selectedValuesPerFilter = {};
      filters.forEach(filter => {
        selectedValuesPerFilter[filter] = new Set(getSelectedValues(filterElements[filter].checkboxes));
      });

      // Initialize object to keep track of remaining counts for each filter value
      const remainingCounts = {};
      filters.forEach(filter => {
        remainingCounts[filter] = {};
        filterElements[filter].checkboxes.forEach(checkbox => {
          remainingCounts[filter][checkbox.id] = 0;
          remainingCounts[filter]['all'] = 0;
        });
      });

      // Iterate through shuffled videos and apply filters
      let visibleCount = 0, totalCount = 0;
      let video, matchStatusArray, selectedValues, filterIndex, filter;
      for (let i = 0; i < indices.length; i++) { // Slow
        video = videos[indices[i]];

        // Generate match status array for each filter
        matchStatusArray = [];
        for (filterIndex = 0; filterIndex < filters.length; filterIndex++) {
          filter = filters[filterIndex];
          selectedValues = selectedValuesPerFilter[filters[filterIndex]];
          matchStatusArray.push(selectedValues.size === 0 || selectedValues.has(video[`${filter}_id`]));
        }

        // Increment remaining counts applicable filter values
        for (filterIndex = 0; filterIndex < filters.length; filterIndex++) {
          // Ignoring current filter, check if all other filters match
          filter = filters[filterIndex];
          if (matchStatusArray.every((status, statusIndex) => statusIndex === filterIndex || status)) {
            remainingCounts[filter][video[`${filter}_id`]]++;
            remainingCounts[filter]['all']++;
          }
        }

        // Show videos that match all filters
        if (matchStatusArray.every(status => status)) {
          if (visibleCount < maxVisibleVideos) {
            // Set source and poster of the video element
            videoElements[visibleCount].src = video.src;
            videoElements[visibleCount].poster = video.poster;

            // Make the video element visible
            videoElements[visibleCount].style.display = '';

            // Start observing the video element for lazy loading
            lazyVideoObserver.observe(videoElements[visibleCount]);

            // Update the video overlay
            videoOverlaySpans[visibleCount].innerHTML = video.info; // Note that .textContent does not render HTML elements like <br>
            videoOverlays[visibleCount].style.display = '';

            visibleCount++;
          }
          totalCount++;
        }
      }

      // Hide any unused video containers
      for (let i = visibleCount; i < maxVisibleVideos; i++) {
        videoElements[i].style.display = 'none';
        videoElements[i].src = '';
        videoElements[i].poster = '';
        videoOverlaySpans[i].innerHTML = '';
        videoOverlays[i].style.display = 'none';
      }

      // Reveal the video grid after applying DOM edits
      videoGrid.style.display = '';

      // Update checkbox labels to show remaining counts
      filters.forEach(filter => {
        filterElements[filter].checkboxes.forEach(checkbox => {
          const label = filterElements[filter].checkboxLabels[checkbox.id];
          const count = remainingCounts[filter][checkbox.id];
          filterElements[filter].checkboxCounts[checkbox.id].textContent = count;
          if (count === 0) {
            checkbox.disabled = true;
            label.classList.add('text-muted');
          } else {
            checkbox.disabled = false;
            label.classList.remove('text-muted');
          }
        });
        filterElements[filter].allCheckboxCount.textContent = remainingCounts[filter]['all'];
      });

      // Update info text and button visibility
      if (visibleCount === totalCount) {
        infoTextElement.textContent = `Showing ${totalCount} matches`
        resampleButton.style.display = 'none';
      } else {
        infoTextElement.textContent = `Showing ${visibleCount} matches randomly sampled from ${totalCount} total matches`
        resampleButton.style.display = '';
      }

      // Reshuffle indices
      fisherYatesShuffle(indices);

      // console.timeEnd('filterVideos');
    }

    // Function to set up listener for each group of checkboxes
    function setupCheckboxGroupListener(checkboxGroupId, checkboxes, allCheckbox) {
      document.getElementById(checkboxGroupId).addEventListener('change', function(event) {
        // console.time('checkboxGroupEventListener');
        if (event.target === allCheckbox) {
          const noneSelected = Array.from(checkboxes).every(checkbox => !checkbox.checked);
          if (noneSelected) allCheckbox.checked = true;

          if (allCheckbox.checked) {
            for (const checkbox of checkboxes) {
              checkbox.checked = false;
            }
          }
          filterVideos();
        } else if (event.target.type === 'checkbox') {
          const anySelected = getSelectedValues(checkboxes).length > 0;
          allCheckbox.checked = !anySelected;
          filterVideos();
        }
        // console.timeEnd('checkboxGroupEventListener');
      });
    }

    // Set up event listener for checkbox group
    filters.forEach(filter => {
      const { checkboxes, allCheckbox } = filterElements[filter];
      setupCheckboxGroupListener(`${filter}-checkbox-group`, checkboxes, allCheckbox);
    });

    // Add a click event listener to the "Resample" button
    resampleButton.addEventListener('click', filterVideos);

    // Initial filtering of videos
    filterVideos();

    // Hide page overlay used for preventing user interaction until DOM is ready
    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('page-overlay').style.display = 'none';
    });
  </script>
</body>
</html>
